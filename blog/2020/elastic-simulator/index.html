<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Tu Anh-Nguyen


  | Elasticity Simulation with FreeFEM

</title>
<meta name="description" content="Tu's personal website.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="/assets/css/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü¶Å</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="/blog/2020/elastic-simulator/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


    <script src="/assets/js/distillpub/template.v2.js"></script>
    <script src="/assets/js/distillpub/transforms.v2.js"></script>
    <script src="/assets/js/distillpub/overrides.js"></script>
    
  </head>

  <d-front-matter>
    <script async type="text/json">{
      "title": "Elasticity Simulation with FreeFEM",
      "description": "",
      "published": "January 18, 2020",
      "authors": [
        
        {
          "author": "Tu Anh-Nguyen",
          "authorURL": "/",
          "affiliations": [
            {
              "name": "HUST",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script>
  </d-front-matter>

  <body class="fixed-top-nav sticky-bottom-footer">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="https://tu-na.org/">
       Tu Anh-Nguyen
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">
              blog
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          
          
          
          
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="post distill">

      <d-title>
        <h1>Elasticity Simulation with FreeFEM</h1>
        <p></p>
      </d-title>

      <d-byline></d-byline>

      <d-article>
        <h2 id="the-problem">The Problem</h2>
<p>This blog continues the Finite Element Methods series for some simple physical phenomena simulation. Previously, I have covered the heat equation. In this post, I want to discuss another famous  problem: Elasticity. Concretely, we want to know how object of material deforms under pressure or external force. I will first state the system equation of elasticity before I try to explain what it means (I come from mathematics background, so many concepts in physics appear a little confusing to me)
\(\begin{align}
-div(Ae(u)) &amp; = f \tag{1} \\
u_{| \Gamma_D} &amp; = 0 \tag{2} \\
(Ae(u)).n_{| \Gamma_N} &amp; = g \tag{3}\\
\end{align}\)</p>

<p>Denote</p>

\[A \psi = 2 \mu \psi + \lambda (\text{Tr}(\psi)) I_d ,\]

<p>and</p>

\[e(u) = \frac{1}{2} (\nabla u^T + \nabla u) ,\]

<p>where $\mu$ and $\lambda$ are call Lam$'e$ parameters and are defined as follow:</p>

\[\mu = \frac{E}{2(1 + \nu)} \\
\lambda = \frac{E\nu}{(1+\nu)(1 - 2\nu)}\]

<p>$E$ is <a href="[https://en.wikipedia.org/wiki/Young%27s_modulus](https://en.wikipedia.org/wiki/Young's_modulus)">Young‚Äôs modulus</a> which represents for the stiffness of solid material, and $\nu$ is called <a href="https://en.wikipedia.org/wiki/Poisson's_ratio">Poisson‚Äôs ratio</a> which explains for the phenomenon where the material extends in perpendicular with respect to direction of the force.  $u$ in the system of equation is the direction for which each particle in the object will move under force $f$ and external force on $g$ some boundary $\Gamma_N$.  In fact, I do not really understand why equation (1) is true, but as far as I know the simulation I run on my computer seems right :). One final note before we are going to construct the weak formulation for this problem is the meaning for the boundary conditions. Dirichlet condition for this type of equations is always set to be 0, which means that boundary is kept fixed, which Neumann condition is the external force apply on the object‚Äôs edges.</p>

<h3 id="how-to-construct-weak-solution-">How to construct weak solution ?</h3>

<p>In finite element method, we want to approximate $u$ by basis functions which are defined over all elements of the domain, i.e</p>

\[u = \sum_{i = 1}^k \alpha_i \phi_i,\]

<p>where $\phi_i$ is basis function corresponding to element $i$. The reason why we want to construct the original problem in the form of $\alpha(u, v) = L(v)$ (*) is that in this case, finding coefficient $\alpha_i$ is equivalent to solving a system of linear equations. Finding $u$ which satisfies (*) for every $v$ in the chosen function space (approximated by span {$\phi_1, \phi_2, ‚Ä¶, \phi_k$} is equivalent to finding $u$ which satisfies $\alpha(u, \phi_i) = L(\phi_i)$ for all basis function $\phi_i$. Hence, in its core, we need to solve the following system of equations:</p>

\[\forall i \in \{1, 2, ... , k \} \\
\sum_{j = 1}^k \alpha_j \alpha(\phi_j, \phi_i) = L(\phi_i)\]

<p>Now, we turn back to our system of elasticity. Denote $v$ as test function and belongs to $[H^1_0 (\Omega)]^2$ (we are working on  two dimensional case). The space of test function is usually chosen so that it satisfies the Dirichlet boundary condition. Multiply (1) by $v$ and taking integral on domain $\Omega$, we have:</p>

\[\begin{align}
\int_{\Omega}-div(Ae(u)) &amp; = \int_{\Omega}fv \\
\int_{\Omega} Ae(u) : \nabla v &amp; = \int_{\Omega} fv + \int_{\Gamma_N} gv
\end{align}\]

<h3 id="numerical-solution">Numerical solution</h3>

<p>The following code is to simulate how a elliptic shape deform under gravity.</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">real</span> <span class="n">E</span> <span class="o">=</span> <span class="mf">21e5</span><span class="p">;</span>
<span class="n">real</span> <span class="n">nu</span> <span class="o">=</span> <span class="mf">0.28</span><span class="p">;</span>
<span class="n">real</span> <span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1e4</span><span class="p">;</span>
 <span class="c1">// Mesh</span>
<span class="n">border</span> <span class="nf">C1</span><span class="p">(</span><span class="n">t</span> <span class="o">=</span> <span class="n">pi</span><span class="p">,</span> <span class="mi">0</span><span class="p">){</span><span class="n">x</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">);</span> <span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">);}</span>
<span class="n">border</span> <span class="nf">C2</span><span class="p">(</span><span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="n">t</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
<span class="n">border</span> <span class="nf">C3</span><span class="p">(</span><span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="p">){</span><span class="n">x</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">);</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">);}</span>
<span class="n">border</span> <span class="nf">C4</span><span class="p">(</span><span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
<span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
<span class="n">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="n">buildmesh</span><span class="p">(</span><span class="n">C1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">C2</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">C3</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">C4</span><span class="p">(</span><span class="n">n</span><span class="p">));</span>

<span class="n">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">);</span>
 <span class="c1">// Fespace</span>
<span class="n">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">P2</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>
<span class="n">Vh</span> <span class="n">uu</span><span class="p">,</span> <span class="n">vv</span><span class="p">;</span>

 <span class="c1">// Macro</span>
<span class="n">real</span> <span class="n">sqrt2</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">);</span>
<span class="n">macro</span> <span class="nf">epsilon</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u2</span><span class="p">)</span> <span class="p">[</span><span class="n">dx</span><span class="p">(</span><span class="n">u1</span><span class="p">),</span><span class="n">dy</span><span class="p">(</span><span class="n">u2</span><span class="p">),(</span><span class="n">dy</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span><span class="o">+</span><span class="n">dx</span><span class="p">(</span><span class="n">u2</span><span class="p">))</span><span class="o">/</span><span class="n">sqrt2</span><span class="p">]</span> <span class="c1">//</span>
<span class="n">macro</span> <span class="n">div</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="p">(</span> <span class="n">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">+</span><span class="n">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="p">)</span> <span class="c1">//</span>

<span class="c1">// Problem</span>
<span class="n">real</span> <span class="n">mu</span><span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">));</span>
<span class="n">real</span> <span class="n">lambda</span> <span class="o">=</span> <span class="n">E</span><span class="o">*</span><span class="n">nu</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">));</span>
<span class="n">real</span> <span class="n">T</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">real</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span><span class="n">real</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">T</span><span class="p">;</span> <span class="n">t</span><span class="o">+=</span><span class="n">dt</span><span class="p">)</span> <span class="p">{</span>
<span class="n">solve</span> <span class="n">lame</span><span class="p">([</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">],</span> <span class="p">[</span><span class="n">uu</span><span class="p">,</span> <span class="n">vv</span><span class="p">])</span>
 <span class="o">=</span> <span class="n">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span> <span class="n">lambda</span> <span class="o">*</span> <span class="n">div</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">*</span> <span class="n">div</span><span class="p">(</span><span class="n">uu</span><span class="p">,</span> <span class="n">vv</span><span class="p">)</span> 
	<span class="o">+</span> <span class="mf">2.</span><span class="o">*</span><span class="n">mu</span> <span class="o">*</span> <span class="p">(</span><span class="n">epsilon</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span><span class="err">'</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">(</span><span class="n">uu</span><span class="p">,</span><span class="n">vv</span><span class="p">))</span> <span class="p">)</span> <span class="o">-</span> 
	<span class="n">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span> <span class="n">f</span><span class="o">*</span><span class="n">vv</span> <span class="p">)</span>
 <span class="o">+</span> <span class="n">on</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span> <span class="n">C4</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
<span class="n">count</span> <span class="o">++</span><span class="p">;</span>
<span class="c1">// Plot</span>
 <span class="n">real</span> <span class="n">coef</span><span class="o">=</span> <span class="mf">0.7</span><span class="p">;</span>
 <span class="c1">// Move mesh</span>
<span class="n">Th</span> <span class="o">=</span> <span class="n">movemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="o">+</span><span class="n">u</span><span class="o">*</span><span class="n">coef</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">v</span><span class="o">*</span><span class="n">coef</span><span class="p">]);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">ps</span><span class="o">=</span><span class="s">"./elastic simulation/sol_"</span><span class="o">+</span><span class="n">count</span><span class="o">+</span><span class="s">".jpg"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="row mt-3">                                                           
    <div class="col-sm mt-3 mt-md-0">                                            
        <img class="img-fluid rounded z-depth-0" src="/assets/img/elastic-simulation.gif" />
    </div>                                                                       
</div>
<div class="caption">                                                            
Elastic simulation result
</div>


      </d-article>

      <d-appendix>
        <d-footnote-list></d-footnote-list>
        <d-citation-list></d-citation-list>
      </d-appendix>

    </div>

    <!-- Footer -->

    
<footer class="sticky-bottom mt-5">
  <div class="container">
    &copy; Copyright 2023 Tu Anh Nguyen.
    
    
    
    Last updated: April 29, 2023.
    
  </div>
</footer>



  </body>

  <d-bibliography src="/assets/bibliography/">
  </d-bibliography>

</html>
